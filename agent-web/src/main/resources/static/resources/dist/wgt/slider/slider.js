!function(t,e){t.ui.define("slider",{_data:{viewNum:1,imgInit:2,itemRender:null,imgZoom:!1,loop:!1,stopPropagation:!1,springBackDis:15,autoPlay:!0,autoPlayTime:4e3,animationTime:400,showArr:!0,showDot:!0,slide:null,slideend:null,index:0,_stepLength:1,_direction:1},_create:function(){var e,i=this,a=0,o=[],s=i.data("content");i._initConfig(),(i.root()||i.root(t("<div></div>"))).addClass("ui-slider").appendTo(i.data("container")||(i.root().parent().length?"":document.body)).html('<div class="ui-slider-wheel"><div class="ui-slider-group">'+function(){if(i.data("itemRender"))for(var t=i.data("itemRender");e=t.call(i,a++);)o.push('<div class="ui-slider-item">'+e+"</div>");else for(;e=s[a++];)o.push('<div class="ui-slider-item"><a href="'+e.href+'"><img lazyload="'+e.pic+'"/></a>'+(e.title?"<p>"+e.title+"</p>":"")+"</div>");return o.push(i.data("loop")?'</div><div class="ui-slider-group">'+o.join("")+"</div></div>":"</div></div>"),o.join("")}()),i._addDots()},_setup:function(e){var i=this,a=i.root().addClass("ui-slider");if(i._initConfig(),e)i.data("loop")&&t(".ui-slider-wheel",a).append(t(".ui-slider-group",a).clone());else{var o=a.children(),s=t('<div class="ui-slider-group"></div>').append(o.addClass("ui-slider-item"));a.empty().append(t('<div class="ui-slider-wheel"></div>').append(s).append(i.data("loop")?s.clone():"")),i._addDots()}},_init:function(){var e=this,i=(e.data("index"),e.root()),a=t.proxy(e._eventHandler,e);e._setWidth(),t(e.data("wheel")).on("touchstart touchmove touchend touchcancel webkitTransitionEnd",a),t(window).on("ortchange",a),t(".ui-slider-pre",i).on("tap",function(){e.pre()}),t(".ui-slider-next",i).on("tap",function(){e.next()}),e.on("destroy",function(){clearTimeout(e.data("play")),t(window).off("ortchange",a)}),e.data("autoPlay")&&e._setTimeout()},_initConfig:function(){var t=this._data;t.viewNum>1&&(t.loop=!1,t.showDot=!1,t.imgInit=t.viewNum+1)},_addDots:function(){var e=this,i=e.root(),a=t(".ui-slider-item",i).length/(e.data("loop")?2:1),o=[];if(e.data("showDot")){for(o.push('<p class="ui-slider-dots">');a--;)o.push("<b></b>");o.push("</p>")}e.data("showArr")&&o.push('<span class="ui-slider-pre"><b></b></span><span class="ui-slider-next"><b></b></span>'),i.append(o.join(""))},_setWidth:function(){var e,i,a=this,o=a._data,s=a.root(),n=Math.ceil(s.width()/o.viewNum),r=s.height(),d=o.loop,l=t(".ui-slider-item",s).toArray(),h=l.length,u=t(".ui-slider-wheel",s).width(n*h)[0],c=t(".ui-slider-dots b",s).toArray(),p=t("img",s).toArray(),m=p.concat(),v={},g=o.imgInit||h;for(o.showDot&&(c[0].className="ui-slider-dot-select"),o.imgZoom&&t(m).on("load",function(){var t=this.height,e=this.width,i=Math.min(t,r),a=Math.min(e,n);t/r>e/n?this.style.cssText+="height:"+i+"px;width:"+i/t*e+"px;":this.style.cssText+="height:"+a/e*t+"px;width:"+a+"px",this.onload=null}),e=0;h>e;e++)l[e].style.cssText+="width:"+n+"px;position:absolute;-webkit-transform:translate3d("+e*n+"px,0,0);z-index:"+(900-e),v[e]=d&&e>h/2-1?e-h/2:e,g>e&&(i=m.shift(),i&&(i.src=i.getAttribute("lazyload")),o.loop&&(i=p[e+h/2],i&&(i.src=i.getAttribute("lazyload"))));return a.data({root:s[0],wheel:u,items:l,lazyImgs:m,allImgs:p,length:h,width:n,height:r,dots:c,dotIndex:v,dot:c[0]}),a},_eventHandler:function(t){var e=this;switch(t.type){case"touchmove":e._touchMove(t);break;case"touchstart":e._touchStart(t);break;case"touchcancel":case"touchend":e._touchEnd();break;case"webkitTransitionEnd":e._transitionEnd();break;case"ortchange":e._resize.call(e)}},_touchStart:function(t){var e=this;e.data({pageX:t.touches[0].pageX,pageY:t.touches[0].pageY,S:!1,T:!1,X:0}),e.data("wheel").style.webkitTransitionDuration="0ms"},_touchMove:function(t){var e=this._data,i=e.X=t.touches[0].pageX-e.pageX;if(!e.T){var a=e.index,o=e.length,s=Math.abs(i)<Math.abs(t.touches[0].pageY-e.pageY);e.loop&&(e.index=a>0&&o-1>a?a:a===o-1&&0>i?o/2-1:0===a&&i>0?o/2:a),s||clearTimeout(e.play),e.T=!0,e.S=s}e.S||(e.stopPropagation&&t.stopPropagation(),t.preventDefault(),e.wheel.style.webkitTransform="translate3d("+(i-e.index*e.width)+"px,0,0)")},_touchEnd:function(){var t=this,e=t._data;if(!e.S){var i=e.springBackDis,a=e.X<=-i?Math.ceil(-e.X/e.width):e.X>i?-Math.ceil(e.X/e.width):0;e._stepLength=Math.abs(a),t._slide(e.index+a)}},_slide:function(e,i){var a=this,o=a._data,s=o.length,n=s-o.viewNum+1;return e>-1&&n>e?a._move(e):e>=n?o.loop?(o.wheel.style.cssText+="-webkit-transition:0ms;-webkit-transform:translate3d(-"+(s/2-1)*o.width+"px,0,0);",o._direction=1,t.later(function(){a._move(s/2)},20)):(a._move(n-(i?2:1)),o._direction=-1):(o.loop?(o.wheel.style.cssText+="-webkit-transition:0ms;-webkit-transform:translate3d(-"+s/2*o.width+"px,0,0);",t.later(function(){a._move(s/2-1)},20)):a._move(i?1:0),o._direction=1),a},_move:function(t){var e=this._data,i=e.dotIndex[t];if(this.trigger("slide",i),e.lazyImgs.length){var a=e.allImgs[t];a&&a.src||(a.src=a.getAttribute("lazyload"))}e.showDot&&(e.dot.className="",e.dots[i].className="ui-slider-dot-select",e.dot=e.dots[i]),e.index=t,e.wheel.style.cssText+="-webkit-transition:"+e.animationTime+"ms;-webkit-transform:translate3d(-"+t*e.width+"px,0,0);"},_transitionEnd:function(){var t=this,e=t._data;if(t.trigger("slideend",e.dotIndex[e.index]),e.lazyImgs.length){for(var i=e._stepLength,a=0;i>a;a++){var o=e.lazyImgs.shift();o&&(o.src=o.getAttribute("lazyload")),e.loop&&(o=e.allImgs[e.index+e.length/2],o&&!o.src&&(o.src=o.getAttribute("lazyload")))}e._stepLength=1}t._setTimeout()},_setTimeout:function(){var e=this,i=e._data;return i.autoPlay?(clearTimeout(i.play),i.play=t.later(function(){e._slide.call(e,i.index+i._direction,!0)},i.autoPlayTime),e):e},_resize:function(){var t=this,e=t._data,i=e.root.offsetWidth/e.viewNum,a=e.length,o=e.items;if(!i)return t;e.width=i,clearTimeout(e.play);for(var s=0;a>s;s++)o[s].style.cssText+="width:"+i+"px;-webkit-transform:translate3d("+s*i+"px,0,0);";return e.wheel.style.removeProperty("-webkit-transition"),e.wheel.style.cssText+="width:"+i*a+"px;-webkit-transform:translate3d(-"+e.index*i+"px,0,0);",e._direction=1,t._setTimeout(),t},pre:function(){var t=this;return t._slide(t.data("index")-1),t},next:function(){var t=this;return t._slide(t.data("index")+1),t},stop:function(){var t=this;return clearTimeout(t.data("play")),t.data("autoPlay",!1),t},resume:function(){var t=this;return t.data("_direction",1),t.data("autoPlay",!0),t._setTimeout(),t}})}(Zepto);